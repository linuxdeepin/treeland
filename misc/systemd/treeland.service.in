[Unit]
Description=Treeland global wayland compositor service, only running on DDM.
PartOf=graphical.target
StartLimitIntervalSec=30
StartLimitBurst=2

Requires=seatd.service
After=seatd.service

[Service]
User=dde
Environment=LIBSEAT_BACKEND=seatd
Environment=DSG_APP_ID=org.deepin.dde.treeland
Environment=ASAN_SYMBOLIZER_PATH=/usr/bin/llvm-symbolizer
# For Debug: if enable asan, you can't get it's log from journalctl, so ensure the log to a file
Environment=ASAN_OPTIONS=log_path=/tmp/treeland-asan:detect_leaks=0:abort_on_error=1:symbolize=1
ExecStart=@CMAKE_INSTALL_FULL_BINDIR@/treeland.sh --lockscreen
Restart=on-failure
RestartSec=1s
# Disable logs from treeland.sh to avoid duplicate entries in journalctl
# since exec replaces the process, logs would appear from both treeland.sh and treeland
StandardOutput=null
StandardError=null
